there is an alerts table 
when a new entry is created in alerts table, we will fire the relevant webhook (which is basically notification channel)

alerts table will hold-
id  // alerts table id
tenant_id // tenant id
environment_id // environment id
entity_type // entity type (wallet, entitlement, etc)
entity_id // entity id (wallet id, entitlement id, etc) (optional)
alert_metric // alert metric (credit_balance, ongoing_balance, etc)
alert_state // alert state (ok, in_alarm, etc)
alert_enabled // alert enabled (true, false)
alert_info // alert info (jsonb) // this will hold the alert information like threshold, value_at_time, etc
created_at // created at
updated_at // updated at

each enitity for now will hold the following fields-
alert_enabled // alert enabled (true, false)
alert_config // alert config (jsonb) // this will hold the alert configuration basically  threshold

Note: 
1. no alert_state in entity table, entity will have alert_enabled field and alert_config field
2. alert_state will be in alerts table against each alert
3. only alert_enabled will be in entity table (this is just to track if alert is enabled for the entity)
4. no alert_enabled will be in alerts table

so the cron will be setup as 


request body for cron job will be like this-
tenant_ids[] // tenant ids
env_ids[] // environment ids
entity_type // entity type (wallet, entitlement, etc)
alert_metric // alert metric (credit_balance, ongoing_balance, etc)
entity_ids[] // entity ids (wallet id, entitlement id, etc) (optional to check for only specific entity ids)
threshold // threshold (jsonb) // this will hold the threshold against which we will check the alert_metric value

Note: If threshold is provided in the cron request, use that
If no threshold in request, fall back to the entity's own threshold configuration


now for each tenant x environemet(i.e tenant[0] x environment[0], tenant[1] x environment[1], etc)
we will fetch all the valid entities of the given entity type for the given tenant and environment
    now each entity will hold all its information (like credit_balance, ongoing_balance in case of wallet, etc)
    then we will check if the alert is enabled for this entity (i.e via alert_enabled in wallet table in case of wallet as entity)
    if alert_enabled is false, then we will skip
    else we will check the alert_metric value against the threshold
    if breach is detected, then we will check alert for this entity in alerts table (pull the latest row) List with limit 1
        then if determined alert status i.e alert_state = in_alarm is same as existing db alert status i.e alert_state = in_alarm
            then we will skip
        else we will create a new entry in alert table with alert status in_alarm
        then we will fire the relevant webhook which is basically notification channel

    else if breach is restored i.e determined alert status i.e alert_state = ok is not same as existing db alert status which is in_alarm
        then we will update the alert_state in the alerts table to ok
        then we will fire the relevant webhook which is basically notification channel


## Visuals

<svg aria-roledescription="flowchart-v2" role="graphics-document document" viewBox="-8 -8 916.435546875 1881.484375" style="max-width: 916.435546875px;" xmlns="http://www.w3.org/2000/svg" width="100%" id="mermaid-svg-1755879688791-epc79blsw"><style>#mermaid-svg-1755879688791-epc79blsw{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;fill:rgba(204, 204, 204, 0.87);}#mermaid-svg-1755879688791-epc79blsw .error-icon{fill:#bf616a;}#mermaid-svg-1755879688791-epc79blsw .error-text{fill:#bf616a;stroke:#bf616a;}#mermaid-svg-1755879688791-epc79blsw .edge-thickness-normal{stroke-width:2px;}#mermaid-svg-1755879688791-epc79blsw .edge-thickness-thick{stroke-width:3.5px;}#mermaid-svg-1755879688791-epc79blsw .edge-pattern-solid{stroke-dasharray:0;}#mermaid-svg-1755879688791-epc79blsw .edge-pattern-dashed{stroke-dasharray:3;}#mermaid-svg-1755879688791-epc79blsw .edge-pattern-dotted{stroke-dasharray:2;}#mermaid-svg-1755879688791-epc79blsw .marker{fill:rgba(204, 204, 204, 0.87);stroke:rgba(204, 204, 204, 0.87);}#mermaid-svg-1755879688791-epc79blsw .marker.cross{stroke:rgba(204, 204, 204, 0.87);}#mermaid-svg-1755879688791-epc79blsw svg{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;}#mermaid-svg-1755879688791-epc79blsw .label{font-family:"trebuchet ms",verdana,arial,sans-serif;color:rgba(204, 204, 204, 0.87);}#mermaid-svg-1755879688791-epc79blsw .cluster-label text{fill:#ffffff;}#mermaid-svg-1755879688791-epc79blsw .cluster-label span,#mermaid-svg-1755879688791-epc79blsw p{color:#ffffff;}#mermaid-svg-1755879688791-epc79blsw .label text,#mermaid-svg-1755879688791-epc79blsw span,#mermaid-svg-1755879688791-epc79blsw p{fill:rgba(204, 204, 204, 0.87);color:rgba(204, 204, 204, 0.87);}#mermaid-svg-1755879688791-epc79blsw .node rect,#mermaid-svg-1755879688791-epc79blsw .node circle,#mermaid-svg-1755879688791-epc79blsw .node ellipse,#mermaid-svg-1755879688791-epc79blsw .node polygon,#mermaid-svg-1755879688791-epc79blsw .node path{fill:#1a1a1a;stroke:#2a2a2a;stroke-width:1px;}#mermaid-svg-1755879688791-epc79blsw .flowchart-label text{text-anchor:middle;}#mermaid-svg-1755879688791-epc79blsw .node .label{text-align:center;}#mermaid-svg-1755879688791-epc79blsw .node.clickable{cursor:pointer;}#mermaid-svg-1755879688791-epc79blsw .arrowheadPath{fill:#e5e5e5;}#mermaid-svg-1755879688791-epc79blsw .edgePath .path{stroke:rgba(204, 204, 204, 0.87);stroke-width:2.0px;}#mermaid-svg-1755879688791-epc79blsw .flowchart-link{stroke:rgba(204, 204, 204, 0.87);fill:none;}#mermaid-svg-1755879688791-epc79blsw .edgeLabel{background-color:#1a1a1a99;text-align:center;}#mermaid-svg-1755879688791-epc79blsw .edgeLabel rect{opacity:0.5;background-color:#1a1a1a99;fill:#1a1a1a99;}#mermaid-svg-1755879688791-epc79blsw .labelBkg{background-color:rgba(26, 26, 26, 0.5);}#mermaid-svg-1755879688791-epc79blsw .cluster rect{fill:rgba(64, 64, 64, 0.47);stroke:#30373a;stroke-width:1px;}#mermaid-svg-1755879688791-epc79blsw .cluster text{fill:#ffffff;}#mermaid-svg-1755879688791-epc79blsw .cluster span,#mermaid-svg-1755879688791-epc79blsw p{color:#ffffff;}#mermaid-svg-1755879688791-epc79blsw div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:12px;background:#88c0d0;border:1px solid #30373a;border-radius:2px;pointer-events:none;z-index:100;}#mermaid-svg-1755879688791-epc79blsw .flowchartTitleText{text-anchor:middle;font-size:18px;fill:rgba(204, 204, 204, 0.87);}#mermaid-svg-1755879688791-epc79blsw :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif;}</style><g><marker orient="auto" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="6" viewBox="0 0 10 10" class="marker flowchart" id="mermaid-svg-1755879688791-epc79blsw_flowchart-pointEnd"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 0 L 10 5 L 0 10 z"/></marker><marker orient="auto" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="4.5" viewBox="0 0 10 10" class="marker flowchart" id="mermaid-svg-1755879688791-epc79blsw_flowchart-pointStart"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 5 L 10 10 L 10 0 z"/></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="11" viewBox="0 0 10 10" class="marker flowchart" id="mermaid-svg-1755879688791-epc79blsw_flowchart-circleEnd"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"/></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="-1" viewBox="0 0 10 10" class="marker flowchart" id="mermaid-svg-1755879688791-epc79blsw_flowchart-circleStart"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"/></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="12" viewBox="0 0 11 11" class="marker cross flowchart" id="mermaid-svg-1755879688791-epc79blsw_flowchart-crossEnd"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"/></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="-1" viewBox="0 0 11 11" class="marker cross flowchart" id="mermaid-svg-1755879688791-epc79blsw_flowchart-crossStart"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"/></marker><g class="root"><g class="clusters"/><g class="edgePaths"><path marker-end="url(#mermaid-svg-1755879688791-epc79blsw_flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-A LE-B" id="L-A-B-0" d="M341.787,33.5L341.787,37.667C341.787,41.833,341.787,50.167,341.787,57.617C341.787,65.067,341.787,71.633,341.787,74.917L341.787,78.2"/><path marker-end="url(#mermaid-svg-1755879688791-epc79blsw_flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-B LE-C" id="L-B-C-0" d="M341.787,117L341.787,121.167C341.787,125.333,341.787,133.667,341.787,141.117C341.787,148.567,341.787,155.133,341.787,158.417L341.787,161.7"/><path marker-end="url(#mermaid-svg-1755879688791-epc79blsw_flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-C LE-D" id="L-C-D-0" d="M341.787,200.5L341.787,204.667C341.787,208.833,341.787,217.167,341.853,224.7C341.919,232.234,342.051,238.967,342.117,242.334L342.183,245.701"/><path marker-end="url(#mermaid-svg-1755879688791-epc79blsw_flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-D LE-E" id="L-D-E-0" d="M303.493,408.511L295.454,420.602C287.414,432.692,271.335,456.873,263.295,487.821C255.256,518.768,255.256,556.482,255.256,575.339L255.256,594.196"/><path marker-end="url(#mermaid-svg-1755879688791-epc79blsw_flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-D LE-F" id="L-D-F-0" d="M381.081,408.511L388.954,420.602C396.827,432.692,412.573,456.873,420.516,473.872C428.46,490.872,428.601,500.688,428.671,505.597L428.742,510.505"/><path marker-end="url(#mermaid-svg-1755879688791-epc79blsw_flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-F LE-G" id="L-F-G-0" d="M495.069,651.437L526.973,668.104C558.878,684.771,622.687,718.104,654.592,758.534C686.496,798.964,686.496,846.49,686.496,894.016C686.496,941.542,686.496,989.068,686.496,1017.656C686.496,1046.244,686.496,1055.894,686.496,1060.719L686.496,1065.544"/><path marker-end="url(#mermaid-svg-1755879688791-epc79blsw_flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-F LE-H" id="L-F-H-0" d="M383.983,672.852L373.367,685.95C362.75,699.047,341.518,725.242,330.972,743.248C320.426,761.254,320.568,771.071,320.638,775.98L320.709,780.888"/><path marker-end="url(#mermaid-svg-1755879688791-epc79blsw_flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-H LE-I" id="L-H-I-0" d="M265.221,947.28L249.374,962.165C233.528,977.051,201.834,1006.822,185.987,1026.533C170.141,1046.244,170.141,1055.894,170.141,1060.719L170.141,1065.544"/><path marker-end="url(#mermaid-svg-1755879688791-epc79blsw_flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-I LE-J" id="L-I-J-0" d="M170.141,1104.344L170.141,1108.51C170.141,1112.677,170.141,1121.01,170.141,1128.46C170.141,1135.91,170.141,1142.477,170.141,1145.76L170.141,1149.044"/><path marker-end="url(#mermaid-svg-1755879688791-epc79blsw_flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-H LE-K" id="L-H-K-0" d="M376.349,947.28L392.029,962.165C407.709,977.051,439.07,1006.822,454.75,1026.533C470.43,1046.244,470.43,1055.894,470.43,1060.719L470.43,1065.544"/><path marker-end="url(#mermaid-svg-1755879688791-epc79blsw_flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-G LE-L" id="L-G-L-0" d="M686.496,1104.344L686.496,1108.51C686.496,1112.677,686.496,1121.01,676.538,1129.025C666.58,1137.04,646.665,1144.737,636.707,1148.585L626.749,1152.433"/><path marker-end="url(#mermaid-svg-1755879688791-epc79blsw_flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-K LE-L" id="L-K-L-0" d="M470.43,1104.344L470.43,1108.51C470.43,1112.677,470.43,1121.01,480.387,1129.025C490.345,1137.04,510.261,1144.737,520.219,1148.585L530.177,1152.433"/><path marker-end="url(#mermaid-svg-1755879688791-epc79blsw_flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-L LE-M" id="L-L-M-0" d="M578.463,1187.844L578.463,1192.01C578.463,1196.177,578.463,1204.51,578.529,1212.044C578.595,1219.577,578.727,1226.311,578.793,1229.678L578.859,1233.045"/><path marker-end="url(#mermaid-svg-1755879688791-epc79blsw_flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-M LE-N" id="L-M-N-0" d="M524.137,1356.401L498.309,1371.163C472.481,1385.926,420.824,1415.451,394.996,1435.039C369.168,1454.627,369.168,1464.277,369.168,1469.102L369.168,1473.927"/><path marker-end="url(#mermaid-svg-1755879688791-epc79blsw_flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-M LE-O" id="L-M-O-0" d="M634.503,1355.687L661.317,1370.568C688.13,1385.45,741.757,1415.213,768.571,1434.92C795.385,1454.627,795.385,1464.277,795.385,1469.102L795.385,1473.927"/><path marker-end="url(#mermaid-svg-1755879688791-epc79blsw_flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-N LE-P" id="L-N-P-0" d="M369.168,1512.727L369.168,1516.893C369.168,1521.06,369.168,1529.393,369.244,1542.523C369.32,1555.653,369.471,1573.579,369.547,1582.542L369.623,1591.505"/><path marker-end="url(#mermaid-svg-1755879688791-epc79blsw_flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-P LE-Q" id="L-P-Q-0" d="M342.805,1703.543L332.106,1719.241C321.407,1734.94,300.009,1766.337,289.31,1786.861C278.611,1807.384,278.611,1817.034,278.611,1821.859L278.611,1826.684"/><path marker-end="url(#mermaid-svg-1755879688791-epc79blsw_flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-P LE-R" id="L-P-R-0" d="M396.531,1703.543L407.064,1719.241C417.596,1734.94,438.66,1766.337,449.192,1786.861C459.725,1807.384,459.725,1817.034,459.725,1821.859L459.725,1826.684"/><path marker-end="url(#mermaid-svg-1755879688791-epc79blsw_flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-O LE-S" id="L-O-S-0" d="M795.385,1512.727L795.385,1516.893C795.385,1521.06,795.385,1529.393,795.451,1536.927C795.517,1544.46,795.649,1551.194,795.715,1554.561L795.781,1557.928"/><path marker-end="url(#mermaid-svg-1755879688791-epc79blsw_flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-S LE-T" id="L-S-T-0" d="M757.622,1725.722L750.094,1737.724C742.566,1749.726,727.511,1773.73,719.983,1790.557C712.455,1807.384,712.455,1817.034,712.455,1821.859L712.455,1826.684"/><path marker-end="url(#mermaid-svg-1755879688791-epc79blsw_flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-S LE-U" id="L-S-U-0" d="M834.148,1725.722L841.509,1737.724C848.87,1749.726,863.592,1773.73,870.953,1790.557C878.314,1807.384,878.314,1817.034,878.314,1821.859L878.314,1826.684"/></g><g class="edgeLabels"><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g transform="translate(255.255859375, 481.0546875)" class="edgeLabel"><g transform="translate(-17.12109375, -9.25)" class="label"><foreignObject height="18.5" width="34.2421875"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel">false</span></div></foreignObject></g></g><g transform="translate(428.318359375, 481.0546875)" class="edgeLabel"><g transform="translate(-15.015625, -9.25)" class="label"><foreignObject height="18.5" width="30.03125"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel">true</span></div></foreignObject></g></g><g transform="translate(686.49609375, 894.015625)" class="edgeLabel"><g transform="translate(-11.32421875, -9.25)" class="label"><foreignObject height="18.5" width="22.6484375"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel">Yes</span></div></foreignObject></g></g><g transform="translate(320.28515625, 751.4375)" class="edgeLabel"><g transform="translate(-9.3984375, -9.25)" class="label"><foreignObject height="18.5" width="18.796875"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel">No</span></div></foreignObject></g></g><g transform="translate(170.140625, 1036.59375)" class="edgeLabel"><g transform="translate(-9.3984375, -9.25)" class="label"><foreignObject height="18.5" width="18.796875"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel">No</span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g transform="translate(470.4296875, 1036.59375)" class="edgeLabel"><g transform="translate(-11.32421875, -9.25)" class="label"><foreignObject height="18.5" width="22.6484375"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel">Yes</span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g transform="translate(369.16796875, 1444.9765625)" class="edgeLabel"><g transform="translate(-11.32421875, -9.25)" class="label"><foreignObject height="18.5" width="22.6484375"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel">Yes</span></div></foreignObject></g></g><g transform="translate(795.384765625, 1444.9765625)" class="edgeLabel"><g transform="translate(-9.3984375, -9.25)" class="label"><foreignObject height="18.5" width="18.796875"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel">No</span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g transform="translate(278.611328125, 1797.734375)" class="edgeLabel"><g transform="translate(-11.32421875, -9.25)" class="label"><foreignObject height="18.5" width="22.6484375"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel">Yes</span></div></foreignObject></g></g><g transform="translate(459.724609375, 1797.734375)" class="edgeLabel"><g transform="translate(-9.3984375, -9.25)" class="label"><foreignObject height="18.5" width="18.796875"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel">No</span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g transform="translate(712.455078125, 1797.734375)" class="edgeLabel"><g transform="translate(-11.32421875, -9.25)" class="label"><foreignObject height="18.5" width="22.6484375"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel">Yes</span></div></foreignObject></g></g><g transform="translate(878.314453125, 1797.734375)" class="edgeLabel"><g transform="translate(-9.3984375, -9.25)" class="label"><foreignObject height="18.5" width="18.796875"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel">No</span></div></foreignObject></g></g></g><g class="nodes"><g transform="translate(341.787109375, 16.75)" id="flowchart-A-344" class="node default default flowchart-label"><rect height="33.5" width="87.9453125" y="-16.75" x="-43.97265625" ry="0" rx="0" style="" class="basic label-container"/><g transform="translate(-36.47265625, -9.25)" style="" class="label"><rect/><foreignObject height="18.5" width="72.9453125"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Start Cron</span></div></foreignObject></g></g><g transform="translate(341.787109375, 100.25)" id="flowchart-B-345" class="node default default flowchart-label"><rect height="33.5" width="260.765625" y="-16.75" x="-130.3828125" ry="0" rx="0" style="" class="basic label-container"/><g transform="translate(-122.8828125, -9.25)" style="" class="label"><rect/><foreignObject height="18.5" width="245.765625"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">For each tenant√óenvironment pair</span></div></foreignObject></g></g><g transform="translate(341.787109375, 183.75)" id="flowchart-C-347" class="node default default flowchart-label"><rect height="33.5" width="153.6953125" y="-16.75" x="-76.84765625" ry="0" rx="0" style="" class="basic label-container"/><g transform="translate(-69.34765625, -9.25)" style="" class="label"><rect/><foreignObject height="18.5" width="138.6953125"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Fetch valid entities</span></div></foreignObject></g></g><g transform="translate(341.787109375, 348.65234375)" id="flowchart-D-349" class="node default default flowchart-label"><polygon style="" transform="translate(-98.15234375,98.15234375)" class="label-container" points="98.15234375,0 196.3046875,-98.15234375 98.15234375,-196.3046875 0,-98.15234375"/><g transform="translate(-73.90234375, -9.25)" style="" class="label"><rect/><foreignObject height="18.5" width="147.8046875"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Check alert_enabled</span></div></foreignObject></g></g><g transform="translate(255.255859375, 616.24609375)" id="flowchart-E-351" class="node default default flowchart-label"><rect height="33.5" width="44.2421875" y="-16.75" x="-22.12109375" ry="0" rx="0" style="" class="basic label-container"/><g transform="translate(-14.62109375, -9.25)" style="" class="label"><rect/><foreignObject height="18.5" width="29.2421875"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Skip</span></div></foreignObject></g></g><g transform="translate(428.318359375, 616.24609375)" id="flowchart-F-353" class="node default default flowchart-label"><polygon style="" transform="translate(-100.94140625,100.94140625)" class="label-container" points="100.94140625,0 201.8828125,-100.94140625 100.94140625,-201.8828125 0,-100.94140625"/><g transform="translate(-76.69140625, -9.25)" style="" class="label"><rect/><foreignObject height="18.5" width="153.3828125"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Threshold in request?</span></div></foreignObject></g></g><g transform="translate(686.49609375, 1087.59375)" id="flowchart-G-355" class="node default default flowchart-label"><rect height="33.5" width="171.8359375" y="-16.75" x="-85.91796875" ry="0" rx="0" style="" class="basic label-container"/><g transform="translate(-78.41796875, -9.25)" style="" class="label"><rect/><foreignObject height="18.5" width="156.8359375"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Use request threshold</span></div></foreignObject></g></g><g transform="translate(320.28515625, 894.015625)" id="flowchart-H-357" class="node default default flowchart-label"><polygon style="" transform="translate(-108.328125,108.328125)" class="label-container" points="108.328125,0 216.65625,-108.328125 108.328125,-216.65625 0,-108.328125"/><g transform="translate(-84.078125, -9.25)" style="" class="label"><rect/><foreignObject height="18.5" width="168.15625"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Entity has alert_config?</span></div></foreignObject></g></g><g transform="translate(170.140625, 1087.59375)" id="flowchart-I-359" class="node default default flowchart-label"><rect height="33.5" width="340.28125" y="-16.75" x="-170.140625" ry="0" rx="0" style="" class="basic label-container"/><g transform="translate(-162.640625, -9.25)" style="" class="label"><rect/><foreignObject height="18.5" width="325.28125"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Log Error: Missing threshold for enabled alert</span></div></foreignObject></g></g><g transform="translate(170.140625, 1171.09375)" id="flowchart-J-361" class="node default default flowchart-label"><rect height="33.5" width="44.2421875" y="-16.75" x="-22.12109375" ry="0" rx="0" style="" class="basic label-container"/><g transform="translate(-14.62109375, -9.25)" style="" class="label"><rect/><foreignObject height="18.5" width="29.2421875"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Skip</span></div></foreignObject></g></g><g transform="translate(470.4296875, 1087.59375)" id="flowchart-K-363" class="node default default flowchart-label"><rect height="33.5" width="160.296875" y="-16.75" x="-80.1484375" ry="0" rx="0" style="" class="basic label-container"/><g transform="translate(-72.6484375, -9.25)" style="" class="label"><rect/><foreignObject height="18.5" width="145.296875"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Use entity threshold</span></div></foreignObject></g></g><g transform="translate(578.462890625, 1171.09375)" id="flowchart-L-365" class="node default default flowchart-label"><rect height="33.5" width="201.328125" y="-16.75" x="-100.6640625" ry="0" rx="0" style="" class="basic label-container"/><g transform="translate(-93.1640625, -9.25)" style="" class="label"><rect/><foreignObject height="18.5" width="186.328125"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Check metric vs threshold</span></div></foreignObject></g></g><g transform="translate(578.462890625, 1324.28515625)" id="flowchart-M-369" class="node default default flowchart-label"><polygon style="" transform="translate(-86.44140625,86.44140625)" class="label-container" points="86.44140625,0 172.8828125,-86.44140625 86.44140625,-172.8828125 0,-86.44140625"/><g transform="translate(-62.19140625, -9.25)" style="" class="label"><rect/><foreignObject height="18.5" width="124.3828125"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Breach detected?</span></div></foreignObject></g></g><g transform="translate(369.16796875, 1495.9765625)" id="flowchart-N-371" class="node default default flowchart-label"><rect height="33.5" width="157.546875" y="-16.75" x="-78.7734375" ry="0" rx="0" style="" class="basic label-container"/><g transform="translate(-71.2734375, -9.25)" style="" class="label"><rect/><foreignObject height="18.5" width="142.546875"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Check existing alert</span></div></foreignObject></g></g><g transform="translate(795.384765625, 1495.9765625)" id="flowchart-O-373" class="node default default flowchart-label"><rect height="33.5" width="167.6015625" y="-16.75" x="-83.80078125" ry="0" rx="0" style="" class="basic label-container"/><g transform="translate(-76.30078125, -9.25)" style="" class="label"><rect/><foreignObject height="18.5" width="152.6015625"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Check for restoration</span></div></foreignObject></g></g><g transform="translate(369.16796875, 1663.10546875)" id="flowchart-P-375" class="node default default flowchart-label"><polygon style="" transform="translate(-66.80078125,66.80078125)" class="label-container" points="66.80078125,0 133.6015625,-66.80078125 66.80078125,-133.6015625 0,-66.80078125"/><g transform="translate(-42.55078125, -9.25)" style="" class="label"><rect/><foreignObject height="18.5" width="85.1015625"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Same state?</span></div></foreignObject></g></g><g transform="translate(278.611328125, 1848.734375)" id="flowchart-Q-377" class="node default default flowchart-label"><rect height="33.5" width="44.2421875" y="-16.75" x="-22.12109375" ry="0" rx="0" style="" class="basic label-container"/><g transform="translate(-14.62109375, -9.25)" style="" class="label"><rect/><foreignObject height="18.5" width="29.2421875"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Skip</span></div></foreignObject></g></g><g transform="translate(459.724609375, 1848.734375)" id="flowchart-R-379" class="node default default flowchart-label"><rect height="33.5" width="217.984375" y="-16.75" x="-108.9921875" ry="0" rx="0" style="" class="basic label-container"/><g transform="translate(-101.4921875, -9.25)" style="" class="label"><rect/><foreignObject height="18.5" width="202.984375"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Create new alert + webhook</span></div></foreignObject></g></g><g transform="translate(795.384765625, 1663.10546875)" id="flowchart-S-381" class="node default default flowchart-label"><polygon style="" transform="translate(-100.37890625,100.37890625)" class="label-container" points="100.37890625,0 200.7578125,-100.37890625 100.37890625,-200.7578125 0,-100.37890625"/><g transform="translate(-76.12890625, -9.25)" style="" class="label"><rect/><foreignObject height="18.5" width="152.2578125"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">State changed to OK?</span></div></foreignObject></g></g><g transform="translate(712.455078125, 1848.734375)" id="flowchart-T-383" class="node default default flowchart-label"><rect height="33.5" width="187.4765625" y="-16.75" x="-93.73828125" ry="0" rx="0" style="" class="basic label-container"/><g transform="translate(-86.23828125, -9.25)" style="" class="label"><rect/><foreignObject height="18.5" width="172.4765625"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Update alert + webhook</span></div></foreignObject></g></g><g transform="translate(878.314453125, 1848.734375)" id="flowchart-U-385" class="node default default flowchart-label"><rect height="33.5" width="44.2421875" y="-16.75" x="-22.12109375" ry="0" rx="0" style="" class="basic label-container"/><g transform="translate(-14.62109375, -9.25)" style="" class="label"><rect/><foreignObject height="18.5" width="29.2421875"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Skip</span></div></foreignObject></g></g></g></g></g></svg>